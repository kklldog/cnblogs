## 关于组件
现在前端几大轮子全面组件化。让我们可以对常用的功能进行封装，以便复用。组件这东西对于搞.NET的同学其实并不陌生，以前ASP.NET WebForm的用户控件其实也是一种组件。它封装html代码，封装业务逻辑，对外提供属性事件等信息，它完完全全就是个组件，只是用户控件跑在服务端，而现在的组件大多数直接跑在前端。现在Blazor Webassembly微软正式把组件带到前端，让我们看看它是怎么玩的。
## 第一个组件
废话不多说下面开始构建第一个组件。这个组件很简单就是绿色的面板加一个标题的容器，我们就叫它GreenPanel吧。     
### 新建Blazor Webassembly项目
前几天的build大会，Blazor Webassembly已经正式release了。我们更像最新版的core sdk就会安装正式版的模板。    
[![tCTG2F.md.png](https://s1.ax1x.com/2020/05/25/tCTG2F.md.png)](https://imgchr.com/i/tCTG2F)   
新建项目选址Blazor Webassembly App项目模板
### 新建GreenPanel组件
在pages命令下新建一个文件夹叫做components，在文件夹下新建一个razor组件，命名为GreenPanel.razor。
> 注意：组件的命名必选大写字母开头    

[![tCTubn.md.png](https://s1.ax1x.com/2020/05/25/tCTubn.md.png)](https://imgchr.com/i/tCTubn)    
添加代码如下：   
```
<div class="green-panel">
    <div class="title">
        Green panel
    </div>
    <div class="content">
    </div>
</div>

<style>
    .green-panel{
        background-color: green;
        height:400px;
        width:400px;
    }
    .green-panel .title {
        border-bottom:1px solid #333;
        height:30px;
    }
    .green-panel .content {
    }
</style>

@code { override void OnInitialized()
        {
            base.OnInitialized();
        }
}

```
一个组件主要是由html，style ，code等组成。html，style用来控制ui表现层，code用来封装逻辑。
>注意：Blazor目前没有样式隔离技术，所以写在组件内的style有可能会影响其他html元素

### 使用组件
使用组件跟其他组件大体是相同的，直接在需要使用的地方使用以我们组件名作为一个html元素插入：   
如果不在同一层目录下，则需要导入命名空间。在_Imports.razor文件内引用组件的命名空间：
```
...
@using BlazorWasmComponent.Components

```
在index页面使用组件：
```
<GreenPanel></GreenPanel>
```
运行一下：    
[![tCbQUI.md.png](https://s1.ax1x.com/2020/05/25/tCbQUI.md.png)](https://imgchr.com/i/tCbQUI)
### 组件类
每个组件最后都会编译成一个C#类，让我们用ILSPy看看一眼长啥样：
```
// BlazorWasmComponent.Components.GreenPanel
using Microsoft.AspNetCore.Components;
using Microsoft.AspNetCore.Components.Rendering;

public class GreenPanel : ComponentBase
{
	protected override void BuildRenderTree(RenderTreeBuilder __builder)
	{
		__builder.AddMarkupContent(0, "<div class=\"green-panel\">\r\n    <div class=\"title\">\r\n        Green panel\r\n    </div>\r\n    <div class=\"content\">\r\n    </div>\r\n</div>\r\n\r\n");
		__builder.AddMarkupContent(1, "<style>\r\n    .green-panel{\r\n        background-color: green;\r\n        height:400px;\r\n        width:400px;\r\n    }\r\n    .green-panel .title {\r\n        border-bottom:1px solid #333;\r\n        height:30px;\r\n    }\r\n    .green-panel .content {\r\n    }\r\n</style>");
	}

	protected override void OnInitialized()
	{
		base.OnInitialized();
	}
}

```
GreenPanel组件会编译成一个GreenPanel类，继承自ComponentBase基类。里面有几个方法：
1. BuildRenderTree 用来构建html，css等ui元素
2. 其它code部分会也会被合并到这个类里面
### 生命周期
了解组件声明周期对我们使用组件有很大的帮助。一个组件的声周期主要依次以下几个阶段：
1. OnInitialized、OnInitializedAsync
2. OnParametersSet、OnParametersSetAsync
3. OnAfterRender、OnAfterRenderAsync
4. Dispose

如果要在每个生命阶段插入特定的逻辑，请重写这些方法：
```
@implements IDisposable

@code {
    protected override void OnInitialized()
    {
        Console.WriteLine("OnInitialized");
        base.OnInitialized();
    }
    protected override Task OnInitializedAsync()
    {
        Console.WriteLine("OnInitializedAsync");
        return base.OnInitializedAsync();
    }
    protected override void OnParametersSet()
    {
        Console.WriteLine("OnParametersSet");
        base.OnParametersSet();
    }
    protected override Task OnParametersSetAsync()
    {
        Console.WriteLine("OnParametersSetAsync");

        return base.OnParametersSetAsync();
    }
    protected override void OnAfterRender(bool firstRender)
    {
        Console.WriteLine("OnAfterRender");
        base.OnAfterRender(firstRender);
    }
    protected override Task OnAfterRenderAsync(bool firstRender)
    {
        Console.WriteLine("OnAfterRenderAsync");
        return base.OnAfterRenderAsync(firstRender);
    }

    public void Dispose()
    {
        Console.WriteLine("Dispose");
    }
}
```
> 注意：组件默认并不实现implements方法继承接口IDisposable接口，如果要在重写Dispose方法请手工使用@implements方法继承接口IDisposable

运行一下，并且切换一下页面，使组件销毁，可以看到所有生命周期方法依次执行：    
[![tCO5in.md.png](https://s1.ax1x.com/2020/05/26/tCO5in.md.png)](https://imgchr.com/i/tCO5in)
## 组件属性
## 组件事件
## 引用组件
## @key