## 使用 docker 安装
```
docker run --name seq -e ACCEPT_EULA=Y -p 8900:80 -p 5341:5341 datalust/seq
```
使用 docker run 运行一个实例。8900 绑定容器的 80 端口，该端口是 web 管理界面的入口。5341 绑定容器的 5341 端口，该端口是日志写入时候真正的端口。
## 使用 docker-compose 安装
```
  seq_server:
    image: datalust/seq
    restart: always
    container_name: seq_server
    hostname: seq_server
    environment:
      - ACCEPT_EULA=Y
    ports:
      - 8900:80
      - 5341:5341
```
把上面的 docker 命令改写成 docker-compose 命令。   
安装好 seq 之后，我们访问一下 http://localhost:8090 如果管理后台出现说明我们安装成功了。   
![](https://ftp.bmp.ovh/imgs/2021/06/4227d3cc1fe23e00.png)   
## NLog 集成 Seq
seq 安装成功之后，我们可以开始跟 asp.net core 项目进行集成了。这里采用 Nlog 日志组件进行演示，如何跟 seq 集成。
![](https://ftp.bmp.ovh/imgs/2021/06/62d52d49194ef6b7.png)    
![](https://ftp.bmp.ovh/imgs/2021/06/f11956c598c8c1cb.png)   

```
Install-Package NLog.Targets.Seq
```
nuget 安装 Nlog 的 Seq 扩展。
```
<?xml version="1.0" encoding="utf-8" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      autoReload="true"
      internalLogLevel="info"
      internalLogFile="logs/internal-nlog.txt">

  <extensions>
    <add assembly="NLog.Targets.Seq"/>
  </extensions>
  <!-- the targets to write to -->
  <targets>

    <!-- write to the void aka just remove -->
    <target xsi:type="Null" name="blackhole" />

    <target name="seq" xsi:type="BufferingWrapper" bufferSize="1000" flushTimeout="2000"  >
      <target xsi:type="Seq" serverUrl="http://192.168.18.164:5341" apiKey="vuRYxr8bMXuvKNbwVNUp">
        <property name="ThreadId" value="${threadid}" as="number" />
        <property name="stacktrace" value="${onexception:inner=${stacktrace}}"/>
      </target>
    </target>
  </targets>

  <!-- rules to map from logger name to target -->
  <rules>
    <!--Skip Microsoft logs and so log only own logs-->
    <logger name="Microsoft.*" minlevel="Trace" writeTo="blackhole" final="true" />

    <logger name="*" minlevel="Trace" writeTo="seq" />
  </rules>
</nlog>
```
在项目根目录添加一个 nlog.config 的 xml 配置文件。添加一个 seq 的 target ，在这个 target 上填写 serverUrl（seq的服务地址），apiKey。
```
        public static IHostBuilder CreateHostBuilder(string[] args) =>
            Host.CreateDefaultBuilder(args)
                .ConfigureWebHostDefaults(webBuilder =>
                {
                    webBuilder.ConfigureKestrel(options =>
                    {
                        options.ListenAnyIP(6003);
                    });
                    webBuilder.UseStartup<Startup>();
                })
                .UseNLog();
```
在 Program 文件的 CreateHostBuilder 方法最后追加 UseNLog 调用。
```
    [ApiController]
    [Route("[controller]")]
    public class TestController : ControllerBase
    {
        private readonly ILogger _logger;

        public TestController(ILoggerFactory loggerFactory)
        {
            _logger = loggerFactory.CreateLogger<TestController>();
        }

        [HttpGet("TestLogSeq")]
        public string TestLogSeq()
        {
            _logger.LogTrace("this is a test log for trace level .");
            _logger.LogDebug("this is a test log for debug level .");
            _logger.LogInformation("this is a test log for info level .");
            _logger.LogWarning("this is a test log for warning level .");
            _logger.LogError(new Exception("this is a ex for seq log ."), "this is a test log for error level .");

            return "ok";
        }
    }
```
添加一个 TestController 编写一个 TestLogSeq 方法，在这里打一些日志。
![](https://ftp.bmp.ovh/imgs/2021/06/fdd369cc647bbf69.png)   
我们访问一下这个接口，打开 seq 的站点可以看到我们的日志已经写到 seq 里面了。
![](https://ftp.bmp.ovh/imgs/2021/06/0d5e53eacc4176fe.png)   
![](https://ftp.bmp.ovh/imgs/2021/06/36ab3e646e4c2b30.gif)   
![](https://ftp.bmp.ovh/imgs/2021/06/b7e011e8740f72fc.png)   
![](https://ftp.bmp.ovh/imgs/2021/06/f248b6cb75cc19a8.png)    
![](https://ftp.bmp.ovh/imgs/2021/06/01c40f7b870ec604.png)
![](https://ftp.bmp.ovh/imgs/2021/06/202925e96c8c5be5.png)